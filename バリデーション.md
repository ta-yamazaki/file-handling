# ファイルアップロード時のバリデーション

| バリデーション項目 | 説明                                                               | 実装                                                                                                                                                                                         |
|-----------|------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 存在確認      | ファイルが空でないか                                                       | **HTML**<br>inputタグのrequire属性<br>**Java**<br>MultipartFile.isEmpty                                                                                                                         |
| ファイル形式    | 指定されたファイル形式（拡張子）に合致しているか                                         | **HTML**<br>inputタグのaccept属性<br>**Java**<br>MediaType.parseMediaType(file.getContentType();<br>FilenameUtils.getExtension(file.getOriginalFilename());<br>※画像の場合これもあり？→ImageIO.read(file); |
| ファイルサイズ   | 許容範囲を超えていないか                                                     | **Spring application.properties**<br>spring.servlet.multipart.max-file-size=20MB                                                                                                           |
| ユニーク性     | すでに同じ名前のファイルが存在していないか                                            | **Java**<br>                                                                                                                                                                               |
| ファイル名     | 不正な文字や特殊文字を含んでいないか<br>ファイル名にパスが含まれていないか<br>ファイルにスクリプトタグが含まれていないか | **Java**<br>String.contains()                                                                                                                                                              |
| ファイル内容    | CSV/Excelファイルの場合、ヘッダやデータ形式の妥当性を検証                                | **Java**<br>apache.poi                                                                                                                                                                     |
| ユーザー権限    | 許可されたユーザーによるアップロードか                                              | **Spring Security**<br>@PreAuthorize("hasPermission()")                                                                                                                                    |